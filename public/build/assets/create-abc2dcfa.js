import{v as e}from"./index-0d6930bf.js";import"./use-meta-44934223.js";/* empty css                     *//* empty css                                     */import{F as h}from"./file-upload-with-preview.esm-03fb8eae.js";import{q as _}from"./vue3-quill-c4bb341a.js";import{u as w}from"./publications-dab7d2d9.js";import"./_commonjsHelpers-23102255.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./index-ab450292.js";const y={class:"container"},B={class:"container"},k={class:"row"},x={id:"",class:"col-lg-12 layout-spacing layout-top-spacing"},P={class:"statbox panel box box-shadow"},j={class:"panel-body"},F={class:"row"},S={class:"form-group col-md-12"},C={class:"text-danger mt-1"},D={class:"form-group"},L={class:"text-danger mt-1"},T={class:"form-group"},U={class:"text-danger mt-1"},M={class:"custom-file-container","data-upload-id":"myFirstImage"},A={class:"custom-file-container__custom-file",for:"publication_file"},I={class:"mt-1 text-danger"},$={class:"form-group col-md-4"},q={class:"text-danger mt-1"},W=["disabled"],te={__name:"create",setup(J){const u=e.ref(!1),{storePublication:b,validationErrors:m,isLoading:p,publication:o}=w(),v=(n,t)=>{const r=n.split(",")[1],a=atob(r),i=new ArrayBuffer(a.length),c=new Uint8Array(i);for(let l=0;l<a.length;l++)c[l]=a.charCodeAt(l);const s=new Blob([i],{type:"image/jpeg"});return new File([s],t,{type:"image/jpeg"})};async function E(){var n;u.value=!0;try{if((n=o.value)!=null&&n.publication_file){const t=o.value.publication_file,r=await t.arrayBuffer(),{thumbnailBase64:a,width:i,height:c}=await N(r);if(a){const l=`thumbnail-${t.name.replace(".pdf","")}-${i}x${c}.jpg`,d=v(a,l);o.value.thumbnail_path=d}else{console.error("Failed to generate thumbnail");return}}b(o.value,!0)}catch(t){console.error("Error submitting form:",t)}finally{u.value=!1}}const f=e.ref(null),g=async()=>(window.pdfjsLib||(await Promise.all([new Promise(n=>{const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js",t.onload=n,document.head.appendChild(t)}),new Promise(n=>{const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js",t.onload=n,document.head.appendChild(t)})]),await new Promise(n=>setTimeout(n,100))),window.pdfjsLib),N=async(n,t=.5)=>{try{const r=await g(),a=new Uint8Array(n),s=await(await r.getDocument({data:a}).promise).getPage(1),l=s.getViewport({scale:t}),d=f.value,V=d.getContext("2d");return d.width=l.width,d.height=l.height,await s.render({canvasContext:V,viewport:l}).promise,{thumbnailBase64:d.toDataURL("image/jpeg",.8),width:l.width,height:l.height}}catch(r){return console.error("Error generating thumbnail:",r),null}};return e.onMounted(()=>{new h("myFirstImage",{images:{baseImage:"/assets/images/file-preview-pdf.png",backgroundImage:""}})}),(n,t)=>{var r,a,i,c,s;return e.openBlock(),e.createElementBlock("div",y,[(e.openBlock(),e.createBlock(e.Teleport,{to:"#breadcrumb"},[t[5]||(t[5]=e.createElementVNode("ul",{class:"navbar-nav flex-row"},[e.createElementVNode("li",null,[e.createElementVNode("div",{class:"page-header"},[e.createElementVNode("nav",{class:"breadcrumb-one","aria-label":"breadcrumb"},[e.createElementVNode("ol",{class:"breadcrumb"},[e.createElementVNode("li",{class:"breadcrumb-item"},[e.createElementVNode("a",{href:"javascript:;"},"Publication")]),e.createElementVNode("li",{class:"breadcrumb-item active","aria-current":"page"},[e.createElementVNode("span",null,"Create Publication")])])])])])],-1))])),e.createElementVNode("div",B,[e.createElementVNode("div",k,[e.createElementVNode("div",x,[e.createElementVNode("div",P,[t[16]||(t[16]=e.createElementVNode("div",{class:"panel-heading pb-0"},[e.createElementVNode("div",{class:"row"},[e.createElementVNode("div",{class:"col-xl-12 col-md-12 col-sm-12 col-12"},[e.createElementVNode("h3",null,[e.createElementVNode("b",null,"Create Publication")])])])],-1)),e.createElementVNode("div",j,[e.createElementVNode("form",{onSubmit:e.withModifiers(E,["prevent"])},[e.createElementVNode("div",F,[e.createElementVNode("div",S,[t[6]||(t[6]=e.createElementVNode("label",{for:"post-name"},"Title",-1)),e.withDirectives(e.createElementVNode("input",{id:"post-name","onUpdate:modelValue":t[0]||(t[0]=l=>e.unref(o).name=l),type:"text",class:"form-control",placeholder:"Enter Title ..."},null,512),[[e.vModelText,e.unref(o).name]]),e.createElementVNode("div",C,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((r=e.unref(m))==null?void 0:r.name,l=>(e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(l),1))),256))])]),e.createElementVNode("div",D,[t[8]||(t[8]=e.createElementVNode("label",{for:"post-category",class:"form-label"},"Type",-1)),e.withDirectives(e.createElementVNode("select",{id:"type","onUpdate:modelValue":t[1]||(t[1]=l=>e.unref(o).type=l),class:"form-select form-control",name:"type"},t[7]||(t[7]=[e.createElementVNode("option",{selected:"",disabled:"",value:""}," Select Publication Type ",-1),e.createElementVNode("option",{value:"Brochures"}," Brochures ",-1),e.createElementVNode("option",{value:"Newsletter"}," Newsletter ",-1)]),512),[[e.vModelSelect,e.unref(o).type]]),e.createElementVNode("div",L,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((a=e.unref(m))==null?void 0:a.type,l=>(e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(l),1))),256))])]),e.createElementVNode("div",T,[t[9]||(t[9]=e.createElementVNode("label",{for:"post-content"}," Description",-1)),e.createVNode(e.unref(_),{value:e.unref(o).content,"onUpdate:value":t[2]||(t[2]=l=>e.unref(o).content=l),placeholder:"Enter Blog Content ..."},null,8,["value"]),e.createElementVNode("div",U,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((i=e.unref(m))==null?void 0:i.content,l=>(e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(l),1))),256))])]),e.createElementVNode("div",M,[t[12]||(t[12]=e.createElementVNode("label",null,[e.createTextVNode("Upload File (Must be pdf) "),e.createElementVNode("a",{href:"javascript:void(0)",class:"custom-file-container__image-clear",title:"Clear File"},"x")],-1)),e.createElementVNode("label",A,[e.createElementVNode("input",{id:"publication_file",type:"file",class:"custom-file-container__custom-file__custom-file-input",accept:"application/pdf",onChange:t[3]||(t[3]=l=>e.unref(o).publication_file=l.target.files[0])},null,32),t[10]||(t[10]=e.createElementVNode("input",{type:"hidden",name:"MAX_FILE_SIZE",value:"10485760"},null,-1)),t[11]||(t[11]=e.createElementVNode("span",{class:"custom-file-container__custom-file__custom-file-control"},null,-1))]),e.createElementVNode("div",I,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((c=e.unref(m))==null?void 0:c.publication_file,l=>(e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(l),1))),256))]),t[13]||(t[13]=e.createElementVNode("div",{class:"custom-file-container__image-preview"},null,-1))]),e.createElementVNode("div",$,[t[15]||(t[15]=e.createElementVNode("label",{for:"is_published",class:"col-form-label"},"Publishing Status",-1)),e.createElementVNode("div",null,[e.withDirectives(e.createElementVNode("select",{id:"is_published","onUpdate:modelValue":t[4]||(t[4]=l=>e.unref(o).is_published=l),class:"form-select"},t[14]||(t[14]=[e.createElementVNode("option",{value:""}," Select Publishing Status ... ",-1),e.createElementVNode("option",{selected:"",value:"1"}," Published ",-1),e.createElementVNode("option",{value:"0"}," Not Published ",-1)]),512),[[e.vModelSelect,e.unref(o).is_published]])]),e.createElementVNode("div",q,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList((s=e.unref(m))==null?void 0:s.is_published,l=>(e.openBlock(),e.createElementBlock("div",null,e.toDisplayString(l),1))),256))])])]),e.createElementVNode("canvas",{ref_key:"thumbnailCanvas",ref:f,style:{display:"none"}},null,512),e.createElementVNode("button",{disabled:e.unref(p)||u.value,class:"btn btn-primary mt-3"},[e.createElementVNode("span",null,e.toDisplayString(e.unref(p)||u.value?"Processing...":"Save"),1)],8,W)],32)])])])])])])}}};export{te as default};
