import{aw as V,ax as he,ay as d,az as k,a0 as X,p as E,s as ke,aA as be,h as g,aB as b,aC as Te,aD as ee,aE as we,aF as $e,aG as Fe,aH as Pe,aI as Y,aJ as _,aK as Ae,aL as Be,aM as Me,V as z,aN as Ne,aO as Le,u as G,Z as Oe,aP as Re,q as B,aa as Se,aQ as $}from"./app-setting.117d1b60.js";import{c as Ie,B as De,M as h,o as Ee,i as je}from"./Modal.3c3cfee1.js";function He(e,a,s){V(he(e,d({},a)),s)}const Ve=()=>{const e=k(!1);return X(()=>{e.value=!0}),e},ze=Ve,qe={type:{type:String},actionFn:Function,close:Function,autofocus:Boolean,prefixCls:String,buttonProps:Te(),emitEvent:Boolean,quitOnNullishReturnValue:Boolean};function J(e){return!!(e&&e.then)}const Z=E({compatConfig:{MODE:3},name:"ActionButton",props:qe,setup(e,a){let{slots:s}=a;const l=k(!1),y=k(),n=k(!1);let f;const C=ze();ke(()=>{e.autofocus&&(f=setTimeout(()=>{var t,r;return(r=(t=be(y.value))===null||t===void 0?void 0:t.focus)===null||r===void 0?void 0:r.call(t)}))}),X(()=>{clearTimeout(f)});const x=function(){for(var t,r=arguments.length,o=new Array(r),v=0;v<r;v++)o[v]=arguments[v];(t=e.close)===null||t===void 0||t.call(e,...o)},u=t=>{!J(t)||(n.value=!0,t.then(function(){C.value||(n.value=!1),x(...arguments),l.value=!1},r=>(C.value||(n.value=!1),l.value=!1,Promise.reject(r))))},i=t=>{const{actionFn:r}=e;if(l.value)return;if(l.value=!0,!r){x();return}let o;if(e.emitEvent){if(o=r(t),e.quitOnNullishReturnValue&&!J(o)){l.value=!1,x(t);return}}else if(r.length)o=r(e.close),l.value=!1;else if(o=r(),!o){x();return}u(o)};return()=>{const{type:t,prefixCls:r,buttonProps:o}=e;return g(De,b(b(b({},Ie(t)),{},{onClick:i,loading:n.value,prefixCls:r},o),{},{ref:y}),s)}}});function M(e){return typeof e=="function"?e():e}const te=E({name:"ConfirmDialog",inheritAttrs:!1,props:["icon","onCancel","onOk","close","closable","zIndex","afterClose","visible","open","keyboard","centered","getContainer","maskStyle","okButtonProps","cancelButtonProps","okType","prefixCls","okCancel","width","mask","maskClosable","okText","cancelText","autoFocusButton","transitionName","maskTransitionName","type","title","content","direction","rootPrefixCls","bodyStyle","closeIcon","modalRender","focusTriggerAfterClose","wrapClassName","confirmPrefixCls","footer"],setup(e,a){let{attrs:s}=a;const[l]=ee("Modal");return()=>{const{icon:y,onCancel:n,onOk:f,close:C,okText:x,closable:u=!1,zIndex:i,afterClose:t,keyboard:r,centered:o,getContainer:v,maskStyle:c,okButtonProps:m,cancelButtonProps:R,okCancel:A,width:p=416,mask:F=!0,maskClosable:T=!1,type:w,open:S,title:q,content:ce,direction:ie,closeIcon:ue,modalRender:fe,focusTriggerAfterClose:de,rootPrefixCls:I,bodyStyle:ve,wrapClassName:Ce,footer:Q}=e;let N=y;if(!y&&y!==null)switch(w){case"info":N=g(Pe,null,null);break;case"success":N=g(Fe,null,null);break;case"error":N=g($e,null,null);break;default:N=g(we,null,null)}const me=e.okType||"primary",j=e.prefixCls||"ant-modal",L=`${j}-confirm`,ge=s.style||{},K=A!=null?A:w==="confirm",W=e.autoFocusButton===null?!1:e.autoFocusButton||"ok",D=`${j}-confirm`,ye=Y(D,`${D}-${e.type}`,{[`${D}-rtl`]:ie==="rtl"},s.class),H=l.value,pe=K&&g(Z,{actionFn:n,close:C,autofocus:W==="cancel",buttonProps:R,prefixCls:`${I}-btn`},{default:()=>[M(e.cancelText)||H.cancelText]});return g(h,{prefixCls:j,class:ye,wrapClassName:Y({[`${D}-centered`]:!!o},Ce),onCancel:xe=>C==null?void 0:C({triggerCancel:!0},xe),open:S,title:"",footer:"",transitionName:_(I,"zoom",e.transitionName),maskTransitionName:_(I,"fade",e.maskTransitionName),mask:F,maskClosable:T,maskStyle:c,style:ge,bodyStyle:ve,width:p,zIndex:i,afterClose:t,keyboard:r,centered:o,getContainer:v,closable:u,closeIcon:ue,modalRender:fe,focusTriggerAfterClose:de},{default:()=>[g("div",{class:`${L}-body-wrapper`},[g("div",{class:`${L}-body`},[M(N),q===void 0?null:g("span",{class:`${L}-title`},[M(q)]),g("div",{class:`${L}-content`},[M(ce)])]),Q!==void 0?M(Q):g("div",{class:`${L}-btns`},[pe,g(Z,{type:me,actionFn:f,close:C,autofocus:W==="ok",buttonProps:m,prefixCls:`${I}-btn`},{default:()=>[M(x)||(K?H.okText:H.justOkText)]})])])]})}}}),Qe=[],P=Qe,Ke=e=>{const a=document.createDocumentFragment();let s=d(d({},Ee(e,["parentContext","appContext"])),{close:n,open:!0}),l=null;function y(){l&&(V(null,a),l=null);for(var u=arguments.length,i=new Array(u),t=0;t<u;t++)i[t]=arguments[t];const r=i.some(o=>o&&o.triggerCancel);e.onCancel&&r&&e.onCancel(()=>{},...i.slice(1));for(let o=0;o<P.length;o++)if(P[o]===n){P.splice(o,1);break}}function n(){for(var u=arguments.length,i=new Array(u),t=0;t<u;t++)i[t]=arguments[t];s=d(d({},s),{open:!1,afterClose:()=>{typeof e.afterClose=="function"&&e.afterClose(),y.apply(this,i)}}),s.visible&&delete s.visible,f(s)}function f(u){typeof u=="function"?s=u(s):s=d(d({},s),u),l&&He(l,s,a)}const C=u=>{const i=Me,t=i.prefixCls,r=u.prefixCls||`${t}-modal`,o=i.iconPrefixCls,v=Ae();return g(Be,b(b({},i),{},{prefixCls:t}),{default:()=>[g(te,b(b({},u),{},{rootPrefixCls:t,prefixCls:r,iconPrefixCls:o,locale:v,cancelText:u.cancelText||v.cancelText}),null)]})};function x(u){const i=g(C,d({},u));return i.appContext=e.parentContext||e.appContext||i.appContext,V(i,a),i}return l=x(s),P.push(n),{destroy:n,update:f}},O=Ke;function oe(e){return d(d({},e),{type:"warning"})}function ne(e){return d(d({},e),{type:"info"})}function ae(e){return d(d({},e),{type:"success"})}function se(e){return d(d({},e),{type:"error"})}function le(e){return d(d({},e),{type:"confirm"})}const We=()=>({config:Object,afterClose:Function,destroyAction:Function,open:Boolean}),Ye=E({name:"HookModal",inheritAttrs:!1,props:je(We(),{config:{width:520,okType:"primary"}}),setup(e,a){let{expose:s}=a;var l;const y=z(()=>e.open),n=z(()=>e.config),{direction:f,getPrefixCls:C}=Ne(),x=C("modal"),u=C(),i=()=>{var v,c;e==null||e.afterClose(),(c=(v=n.value).afterClose)===null||c===void 0||c.call(v)},t=function(){e.destroyAction(...arguments)};s({destroy:t});const r=(l=n.value.okCancel)!==null&&l!==void 0?l:n.value.type==="confirm",[o]=ee("Modal",Le.Modal);return()=>g(te,b(b({prefixCls:x,rootPrefixCls:u},n.value),{},{close:t,open:y.value,afterClose:i,okText:n.value.okText||(r?o==null?void 0:o.value.okText:o==null?void 0:o.value.justOkText),direction:n.value.direction||f.value,cancelText:n.value.cancelText||(o==null?void 0:o.value.cancelText)}),null)}});let U=0;const _e=E({name:"ElementsHolder",inheritAttrs:!1,setup(e,a){let{expose:s}=a;const l=k([]);return s({addModal:n=>(l.value.push(n),l.value=l.value.slice(),()=>{l.value=l.value.filter(f=>f!==n)})}),()=>l.value.map(n=>n())}});function Ge(){const e=k(null),a=k([]);G(a,()=>{a.value.length&&([...a.value].forEach(f=>{f()}),a.value=[])},{immediate:!0});const s=n=>function(C){var x;U+=1;const u=k(!0),i=k(null),t=k(Oe(C)),r=k({});G(()=>C,p=>{m(d(d({},Re(p)?p.value:p),r.value))});const o=function(){u.value=!1;for(var p=arguments.length,F=new Array(p),T=0;T<p;T++)F[T]=arguments[T];const w=F.some(S=>S&&S.triggerCancel);t.value.onCancel&&w&&t.value.onCancel(()=>{},...F.slice(1))};let v;const c=()=>g(Ye,{key:`modal-${U}`,config:n(t.value),ref:i,open:u.value,destroyAction:o,afterClose:()=>{v==null||v()}},null);v=(x=e.value)===null||x===void 0?void 0:x.addModal(c),v&&P.push(v);const m=p=>{t.value=d(d({},t.value),p)};return{destroy:()=>{i.value?o():a.value=[...a.value,o]},update:p=>{r.value=p,i.value?m(p):a.value=[...a.value,()=>m(p)]}}},l=z(()=>({info:s(ne),success:s(ae),error:s(se),warning:s(oe),confirm:s(le)})),y=Symbol("modalHolderKey");return[l.value,()=>g(_e,{key:y,ref:e},null)]}function re(e){return O(oe(e))}h.useModal=Ge;h.info=function(a){return O(ne(a))};h.success=function(a){return O(ae(a))};h.error=function(a){return O(se(a))};h.warning=re;h.warn=re;h.confirm=function(a){return O(le(a))};h.destroyAll=function(){for(;P.length;){const a=P.pop();a&&a()}};h.install=function(e){return e.component(h.name,h),e};function Ue(){const e=B([]),a=B([]),s=B([]),l=B({name:"",description:""}),y=Se(),n=B({}),f=B(!1),C=async(c=1,m="",R="",A="",p="",F="created_at",T="desc")=>{try{const w=await $("get",`/api/categories?page=${c}&search_id=${m}&search_title=${R}&search_parent_id=${A}&search_global=${p}&order_column=${F}&order_direction=${T}`);e.value=w}catch(w){n.value=w}};return{categoryList:a,categoryMainList:s,categories:e,category:l,getCategories:C,getMainCategoryList:async()=>{try{const c=await $("get","/api/category-main");s.value=c}catch(c){n.value=c}},getSelectedCategoryList:async c=>{try{const m=await $("get",`/api/category-list/${c}`);a.value=m}catch(m){n.value=m}},getCategoryList:async()=>{try{const c=await $("get","/api/category-list");a.value=c}catch(c){n.value=c}},getCategory:async c=>{try{const m=await $("get",`/api/categories/${c}`);l.value=m}catch(m){n.value=m}},storeCategory:async c=>{if(!f.value){f.value=!0,n.value={};try{await $("post","/api/categories",c),y.push({name:"categories.index"}),showToast("Category saved successfully","success")}catch(m){n.value=m}finally{f.value=!1}}},updateCategory:async c=>{if(!f.value){f.value=!0,n.value={};try{await $("put",`/api/categories/${c.id}`,c),y.push({name:"categories.index"}),showToast("Category updated successfully","success")}catch(m){n.value=m}finally{f.value=!1}}},deleteCategory:async c=>{h.confirm({title:"Are you sure?",content:"You won't be able to revert this action!",okText:"Yes, delete it!",okType:"danger",cancelText:"No, cancel",onOk(){$("delete",`/api/categories/${c}`).then(()=>{C(),y.push({name:"categories.index"}),showToast("Category deleted successfully","success")})},onCancel(){console.log("Cancel")}})},validationErrors:n,isLoading:f}}export{Ue as u};
