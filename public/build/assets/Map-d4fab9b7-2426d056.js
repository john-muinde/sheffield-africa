import{v as n}from"./index-f79e0146.js";import{s as v}from"./_plugin-vue_export-helper-dad06003-f875bd67.js";import{A as _}from"./v3-gmaps-491aa14a.js";import{c as b,a as S,y as u}from"./tools-b40e92cf-d03b1370.js";import"./_commonjsHelpers-23102255.js";const w={},I={class:"gmaps-error"};function N(t,l){return n.openBlock(),n.createElementBlock("span",I,[n.renderSlot(t.$slots,"default")])}const O=v(w,[["render",N]]),B={},T={class:"gmaps-spinner"};function z(t,l){return n.openBlock(),n.createElementBlock("span",T)}const E=v(B,[["render",z]]),M={center:{lat:0,lng:0},zoom:2},C=n.defineComponent({name:"GmapsMap",components:{MapSpinner:E,MapError:O},props:{center:{type:Object},clickableIcons:{type:Boolean},heading:{type:[String,Number]},mapTypeId:{type:[String,Object]},options:{type:Object,default:void 0},tilt:{type:[String,Number]},zoom:{type:[String,Number]},throttle:{type:[Number,String],default:100}},emits:{bounds_changed:t=>!0,center_changed:t=>!0,click:t=>!0,contextmenu:t=>!0,dblclick:t=>!0,drag:()=>!0,dragend:()=>!0,dragstart:()=>!0,error:t=>!0,heading_changed:t=>!0,idle:()=>!0,isfractionalzoomenabled_changed:t=>!0,maptypeid_changed:t=>!0,mounted:t=>!0,mousemove:t=>!0,mouseout:t=>!0,mouseover:t=>!0,projection_changed:()=>!0,renderingtype_changed:()=>!0,rightclick:t=>!0,tilesloaded:()=>!0,tilt_changed:t=>!0,unmounted:t=>!0,zoom_changed:t=>!0},setup(t,{emit:l}){let r=null,s=null;const p=[],m=n.ref(),c=n.ref(null),g=n.ref(!1),{throttle:y}=n.toRefs(t),h=S((e,i)=>{c.value=`[${i}]: ${e.message}`,l("error",c.value)},500),f=()=>{if(!s)throw new Error("vue3-gmaps :: getAPI() called before API loaded.");return s},k=()=>{if(!r)throw new Error("vue3-gmaps :: getMap() called before map loaded.");return r};n.provide("$getAPI",f),n.provide("$getMap",k),n.provide("$getThrottle",()=>+t.throttle),n.provide("$handleError",h);const L=e=>{const i=+y.value,o=google.maps.event;p.push(o.addListener(e,"bounds_changed",u(()=>{var a;return l("bounds_changed",((a=e.getBounds())==null?void 0:a.toJSON())||null)},i)),o.addListener(e,"center_changed",u(()=>{var a;return l("center_changed",((a=e.getCenter())==null?void 0:a.toJSON())||null)},i)),o.addListener(e,"drag",u(()=>l("drag"),i)),o.addListener(e,"mousemove",u(a=>{var d;return l("mousemove",((d=a.latLng)==null?void 0:d.toJSON())||null)},i)),o.addListener(e,"idle",u(()=>l("idle"),i)),o.addListener(e,"click",a=>{var d;return l("click",((d=a.latLng)==null?void 0:d.toJSON())||null)}),o.addListener(e,"contextmenu",a=>{var d;return l("contextmenu",((d=a.latLng)==null?void 0:d.toJSON())||null)}),o.addListener(e,"dblclick",a=>{var d;return l("dblclick",((d=a.latLng)==null?void 0:d.toJSON())||null)}),o.addListener(e,"dragend",()=>l("dragend")),o.addListener(e,"dragstart",()=>l("dragstart")),o.addListener(e,"heading_changed",()=>l("heading_changed",e.getHeading()||null)),o.addListener(e,"isfractionalzoomenabled_changed",()=>l("isfractionalzoomenabled_changed",e.getZoom()||null)),o.addListener(e,"maptypeid_changed",()=>l("maptypeid_changed",e.getMapTypeId()||null)),o.addListener(e,"mouseout",a=>{var d;return l("mouseout",((d=a.latLng)==null?void 0:d.toJSON())||null)}),o.addListener(e,"mouseover",a=>{var d;return l("mouseover",((d=a.latLng)==null?void 0:d.toJSON())||null)}),o.addListener(e,"projection_changed",()=>l("projection_changed")),o.addListener(e,"renderingtype_changed",()=>l("renderingtype_changed")),o.addListener(e,"rightclick",a=>{var d;return l("rightclick",((d=a.latLng)==null?void 0:d.toJSON())||null)}),o.addListener(e,"tilesloaded",()=>l("tilesloaded")),o.addListener(e,"tilt_changed",()=>l("tilt_changed",e.getTilt()||null)),o.addListener(e,"zoom_changed",()=>l("zoom_changed",e.getZoom()||null)))};return n.onMounted(()=>{_().then(e=>{s=e;const i={...M,...t.options};t.center&&(i.center=t.center),t.clickableIcons&&(i.clickableIcons=t.clickableIcons),t.heading&&(i.heading=t.heading),t.mapTypeId&&(i.mapTypeId=t.mapTypeId),t.tilt&&(i.tilt=t.tilt),t.zoom&&(i.zoom=t.zoom),r=new e.Map(m.value,i),r&&L(r),l("mounted",r),g.value=!0}).catch(e=>h(e,"Map"))}),n.watch(()=>t.center,e=>{var i;return e===void 0||b(e,(i=r==null?void 0:r.getCenter())==null?void 0:i.toJSON())?null:r==null?void 0:r.setCenter(e)},{deep:!0}),n.watch(()=>t.clickableIcons,e=>e===void 0||e==(r==null?void 0:r.getClickableIcons())?null:r==null?void 0:r.setClickableIcons(e)),n.watch(()=>t.heading,e=>e===void 0||+e==(r==null?void 0:r.getHeading())?null:r==null?void 0:r.setHeading(+e)),n.watch(()=>t.mapTypeId,e=>e===void 0||e==(r==null?void 0:r.getMapTypeId())?null:r==null?void 0:r.setMapTypeId(e)),n.watch(()=>t.options,e=>e?r==null?void 0:r.setOptions(e):null),n.watch(()=>t.tilt,e=>e===void 0||+e==(r==null?void 0:r.getTilt())?null:r==null?void 0:r.setTilt(+e)),n.watch(()=>t.zoom,e=>e===void 0||+e==(r==null?void 0:r.getZoom())?null:r==null?void 0:r.setZoom(+e)),n.onBeforeUnmount(()=>{r&&l("unmounted",r),p.forEach(e=>e.remove()),r&&window.google.maps.event.clearInstanceListeners(r)}),{error:c,ready:g,mapEl:m}}}),J={style:{width:"100%",height:"100%"}},$={ref:"mapEl",style:{width:"100%",height:"100%"}};function x(t,l,r,s,p,m){const c=n.resolveComponent("map-error"),g=n.resolveComponent("map-spinner");return n.openBlock(),n.createElementBlock("div",J,[t.error?(n.openBlock(),n.createBlock(c,{key:0},{default:n.withCtx(()=>[n.createTextVNode(n.toDisplayString(t.error),1)]),_:1})):t.ready?n.createCommentVNode("",!0):(n.openBlock(),n.createBlock(g,{key:1})),n.withDirectives(n.createElementVNode("div",$,null,512),[[n.vShow,t.ready&&!t.error]]),t.ready&&!t.error?n.renderSlot(t.$slots,"default",{key:2}):n.createCommentVNode("",!0)])}const H=v(C,[["render",x]]);export{H as default};
