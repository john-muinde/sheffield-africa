import{v as n}from"./index-516f1143.js";import{c as k}from"./tools-b40e92cf-d03b1370.js";import{s as y}from"./_plugin-vue_export-helper-dad06003-f875bd67.js";import"./_commonjsHelpers-23102255.js";var E=Object.defineProperty,x=(e,t,o)=>t in e?E(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,s=(e,t,o)=>(x(e,typeof t!="symbol"?t+"":t,o),o);class C extends globalThis.google.maps.OverlayView{constructor(t,o,p){super(),s(this,"position"),s(this,"content"),s(this,"onAdd",()=>{const i=this.getPanes();if(!i)throw new Error("Popup Class panes not found.");i.floatPane.appendChild(this.content)}),s(this,"onRemove",()=>this.content.parentElement?this.content.parentElement.removeChild(this.content):null),s(this,"draw",()=>{const i=this.getProjection().fromLatLngToDivPixel(new globalThis.google.maps.LatLng(this.position));if(!i)throw new Error("Popup Class divPosition not found.");this.content.style.left=i.x+"px",this.content.style.top=i.y+"px"}),s(this,"setPosition",i=>{this.position={...i},this.draw()}),this.position=t,this.content=o,p.OverlayView.preventMapHitsAndGesturesFrom(o)}}const P=n.defineComponent({name:"GmapsPopup",props:{background:{type:String,default:"#EEEEEE"},width:{type:String,default:"200px"},height:{type:String,default:"60px"},position:{type:Object,required:!0}},emits:{click:()=>!0,contextmenu:()=>!0,dblclick:()=>!0,mounted:e=>!0,unmounted:e=>!0},setup(e,{emit:t}){const o=n.inject("$getAPI"),p=n.inject("$getMap"),i=n.inject("$handleError"),{background:d,width:r,height:h,position:m}=n.toRefs(e),u=a=>i(a,"Popup"),c=n.ref();let l=null;const g=()=>t("click"),f=()=>t("dblclick"),b=()=>t("contextmenu"),v=p(),w=o();return n.watch(()=>e.position,a=>a===void 0||k(a,l==null?void 0:l.position)?null:l==null?void 0:l.setPosition(a),{deep:!0}),n.onMounted(()=>{try{if(!c.value)return u(new Error("No root node found."));l=new C(m.value,c.value,w),l.setMap(v),t("mounted",l)}catch{u(new Error("There was a problem creating the popup."))}}),n.onBeforeUnmount(()=>{l&&t("unmounted",l),l&&l.setMap(null)}),{root:c,background:d,width:r,height:h,handleClick:g,handleDblclick:f,handleContextmenu:b}}});function $(e,t,o,p,i,d){return n.openBlock(),n.createElementBlock("div",{ref:"root",class:"gmaps-popup-container",onClick:t[0]||(t[0]=n.withModifiers((...r)=>e.handleClick&&e.handleClick(...r),["prevent"])),onDblclick:t[1]||(t[1]=n.withModifiers((...r)=>e.handleDblclick&&e.handleDblclick(...r),["prevent"])),onContextmenu:t[2]||(t[2]=(...r)=>e.handleContextmenu&&e.handleContextmenu(...r))},[n.createElementVNode("div",{class:"gmaps-popup-bubble-anchor",style:n.normalizeStyle(`color: ${e.background};`)},[n.createElementVNode("div",{class:"gmaps-popup-bubble",style:n.normalizeStyle(`background: ${e.background}; maxWidth:${e.width}; maxHeight:${e.height};`)},[n.renderSlot(e.$slots,"default")],4)],4)],544)}const V=y(P,[["render",$]]);export{V as default};
