import{r as l,w as L,o as P,bO as B,bG as r,bH as p,bI as o,e as T,bT as E,bW as m,bN as f,W as M,a3 as $,ac as F,bP as S,bM as I,n as k}from"./index.61f1fa09.js";import{C as g}from"./ContentState.f8c4af6e.js";import"./use-meta.34b728e1.js";import"./_commonjsHelpers.f037b798.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./transition.3e22ba3f.js";const N={class:"main"},O={class:"page-content"},z={class:"container"},V={class:"row"},R={class:"col-lg-10 offset-lg-1"},U=["href","data-slug","data-title","id","data-df-option","thumb"],Q={__name:"Media_Documents",setup(W){const s=l([]),i=l(!1),d=l(null),w=l(null),b=l(!1),h=l(null),C=async()=>(window.pdfjsLib||(await Promise.all([new Promise(e=>{const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js",t.onload=e,document.head.appendChild(t)}),new Promise(e=>{const t=document.createElement("script");t.src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js",t.onload=e,document.head.appendChild(t)})]),await new Promise(e=>setTimeout(e,100))),window.pdfjsLib),D=async(e,t=.5)=>{try{const y=await(await(await C()).getDocument(e).promise).getPage(1),c=y.getViewport({scale:t}),u=h.value,x=u.getContext("2d");return u.width=c.width,u.height=c.height,await y.render({canvasContext:x,viewport:c}).promise,u.toDataURL("image/jpeg",.8)}catch(a){return console.error("Error generating thumbnail:",a),null}},j=()=>{!s.value.length||b.value||(s.value.forEach(e=>{window[`df_option_${e.id}`]={source:`${window.location.origin}/storage/${e.publication_file}`,outline:[],autoEnableOutline:!1,autoEnableThumbnail:!0,overwritePDFOutline:!1,pageSize:"0",is3D:!0,direction:"1",slug:e.slug,wpOptions:"true",id:e.id}}),k(()=>{const e=w.value;e&&e.children.length===s.value.length&&(window.DFLIP&&window.DFLIP.parseBooks?(window.DFLIP.parseBooks(),b.value=!0,console.log("DFlip books initialized successfully")):console.warn("DFLIP library not loaded"))}))},v=async()=>{i.value=!0;try{const t=(await axios.get("/api/get-media-center",{})).data.brochures;for(const a of t){a.slug=a.name.toLowerCase().replace(/ /g,"-");const n="/storage/"+a.publication_file;if(a.thumbnail_path){a.thumb=`${window.location.origin}/storage/${a.thumbnail_path}`;continue}const _=await D(n);a.thumb=_||null}s.value=t,i.value=!1}catch(e){i.value=!1,d.value=e,console.error(e)}};return L(s,e=>{e.length>0&&k(()=>{j()})},{deep:!0}),P(async()=>{await v()}),(e,t)=>{const a=B("router-link");return r(),p("div",null,[o("main",N,[o("div",O,[o("div",z,[o("div",V,[o("div",R,[t[1]||(t[1]=o("h2",{class:"about-us-title"},"Newsletters",-1)),T(a,{to:"/media",class:"btn btn-primary btn-round btn-shadow float-right"},{default:E(()=>t[0]||(t[0]=[o("i",{class:"icon-long-arrow-left"},null,-1),o("span",null,"Back to Media Center",-1)])),_:1}),t[2]||(t[2]=o("p",{class:"lead about-us-lead text-primary mb-1"}," Explore Our Newsletters ",-1)),t[3]||(t[3]=o("p",{class:"about-us-text mb-2"}," Click on the documents to view ",-1)),i.value?(r(),m(g,{key:0,type:"loading",contentType:"Brochures & Catalogs"})):f("",!0),!s.value.length&&!i.value&&d.value==null?(r(),m(g,{key:1,type:"empty",contentType:"Brochures & Catalogs"})):f("",!0),!!d.value&&!i.value?(r(),m(g,{key:2,type:"error",errorSubMessage:d.value.message,contentType:"Brochures & Catalogs",onRetry:v},null,8,["errorSubMessage"])):f("",!0),M(o("div",{class:"dflip-books row media-center",id:"dflip-books",ref_key:"bookContainer",ref:w},[(r(!0),p(F,null,S(s.value,n=>(r(),p("a",{key:n.id,href:`/media/brochures#${n.slug}/`,class:"_df_thumb","data-slug":n.slug,"data-title":n.name,id:`df_${n.id}`,"data-df-option":`df_option_${n.id}`,thumb:n.thumb},I(n.name),9,U))),128))],512),[[$,s.value.length]]),o("canvas",{ref_key:"thumbnailCanvas",ref:h,style:{display:"none"}},null,512)])])])])])])}}};export{Q as default};
