/*! http://keith-wood.name/countdown.html
	Countdown for jQuery v2.1.0.
	Written by Keith Wood (wood.keith{at}optusnet.com.au) January 2008.
	Available under the MIT (http://keith-wood.name/licence.html) license. 
	Please attribute the author if you use it. */(function(m){var S="countdown",d=0,f=1,D=2,T=3,y=4,v=5,g=6;m.JQPlugin.createPlugin({name:S,defaultOptions:{until:null,since:null,timezone:null,serverSync:null,format:"dHMS",layout:"",compact:!1,padZeroes:!1,significant:0,description:"",expiryUrl:"",expiryText:"",alwaysExpire:!1,onExpiry:null,onTick:null,tickInterval:1},regionalOptions:{"":{labels:["Years","Months","Weeks","Days","Hours","Minutes","Seconds"],labels1:["Year","Month","Week","Day","Hour","Minute","Second"],compactLabels:["y","m","w","d"],whichLabels:null,digits:["0","1","2","3","4","5","6","7","8","9"],timeSeparator:":",isRTL:!1}},_rtlClass:S+"-rtl",_sectionClass:S+"-section",_amountClass:S+"-amount",_periodClass:S+"-period",_rowClass:S+"-row",_holdingClass:S+"-holding",_showClass:S+"-show",_descrClass:S+"-descr",_timerElems:[],_init:function(){function e(o){var _=o<1e12?s?window.performance.now()+window.performance.timing.navigationStart:t():o||t();_-n>=1e3&&(i._updateElems(),n=_),r(e)}var i=this;this._super(),this._serverSyncs=[];var t=typeof Date.now=="function"?Date.now:function(){return new Date().getTime()},s=window.performance&&typeof window.performance.now=="function",r=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||null,n=0;!r||m.noRequestAnimationFrame?(m.noRequestAnimationFrame=null,m.countdown._timer=setInterval(function(){i._updateElems()},1e3)):(n=window.animationStartTime||window.webkitAnimationStartTime||window.mozAnimationStartTime||window.oAnimationStartTime||window.msAnimationStartTime||t(),r(e))},UTCDate:function(e,i,t,s,r,n,o,_){typeof i=="object"&&i instanceof Date&&(_=i.getMilliseconds(),o=i.getSeconds(),n=i.getMinutes(),r=i.getHours(),s=i.getDate(),t=i.getMonth(),i=i.getFullYear());var a=new Date;return a.setUTCFullYear(i),a.setUTCDate(1),a.setUTCMonth(t||0),a.setUTCDate(s||1),a.setUTCHours(r||0),a.setUTCMinutes((n||0)-(Math.abs(e)<30?60*e:e)),a.setUTCSeconds(o||0),a.setUTCMilliseconds(_||0),a},periodsToSeconds:function(e){return 31557600*e[0]+2629800*e[1]+604800*e[2]+86400*e[3]+3600*e[4]+60*e[5]+e[6]},resync:function(){var e=this;m("."+this._getMarker()).each(function(){var t=m.data(this,e.name);if(t.options.serverSync){for(var s=null,r=0;r<e._serverSyncs.length;r++)if(e._serverSyncs[r][0]===t.options.serverSync){s=e._serverSyncs[r];break}if(e._eqNull(s[2])){var n=m.isFunction(t.options.serverSync)?t.options.serverSync.apply(this,[]):null;s[2]=(n?new Date().getTime()-n.getTime():0)-s[1]}t._since&&t._since.setMilliseconds(t._since.getMilliseconds()+s[2]),t._until.setMilliseconds(t._until.getMilliseconds()+s[2])}});for(var i=0;i<e._serverSyncs.length;i++)e._eqNull(e._serverSyncs[i][2])||(e._serverSyncs[i][1]+=e._serverSyncs[i][2],delete e._serverSyncs[i][2])},_instSettings:function(e,i){return{_periods:[0,0,0,0,0,0,0]}},_addElem:function(e){this._hasElem(e)||this._timerElems.push(e)},_hasElem:function(e){return m.inArray(e,this._timerElems)>-1},_removeElem:function(e){this._timerElems=m.map(this._timerElems,function(i){return i===e?null:i})},_updateElems:function(){for(var e=this._timerElems.length-1;e>=0;e--)this._updateCountdown(this._timerElems[e])},_optionsChanged:function(e,i,t){t.layout&&(t.layout=t.layout.replace(/&lt;/g,"<").replace(/&gt;/g,">")),this._resetExtraLabels(i.options,t);var s=i.options.timezone!==t.timezone;m.extend(i.options,t),this._adjustSettings(e,i,!this._eqNull(t.until)||!this._eqNull(t.since)||s);var r=new Date;(i._since&&i._since<r||i._until&&i._until>r)&&this._addElem(e[0]),this._updateCountdown(e,i)},_updateCountdown:function(e,i){if(e=e.jquery?e:m(e),i=i||this._getInst(e)){if(e.html(this._generateHTML(i)).toggleClass(this._rtlClass,i.options.isRTL),i._hold!=="pause"&&m.isFunction(i.options.onTick)){var t=i._hold!=="lap"?i._periods:this._calculatePeriods(i,i._show,i.options.significant,new Date);i.options.tickInterval!==1&&this.periodsToSeconds(t)%i.options.tickInterval!==0||i.options.onTick.apply(e[0],[t])}var s=i._hold!=="pause"&&(i._since?i._now.getTime()<i._since.getTime():i._now.getTime()>=i._until.getTime());if(s&&!i._expiring){if(i._expiring=!0,this._hasElem(e[0])||i.options.alwaysExpire){if(this._removeElem(e[0]),m.isFunction(i.options.onExpiry)&&i.options.onExpiry.apply(e[0],[]),i.options.expiryText){var r=i.options.layout;i.options.layout=i.options.expiryText,this._updateCountdown(e[0],i),i.options.layout=r}i.options.expiryUrl&&(window.location=i.options.expiryUrl)}i._expiring=!1}else i._hold==="pause"&&this._removeElem(e[0])}},_resetExtraLabels:function(e,i){var t=null;for(t in i)t.match(/[Ll]abels[02-9]|compactLabels1/)&&(e[t]=i[t]);for(t in e)t.match(/[Ll]abels[02-9]|compactLabels1/)&&typeof i[t]>"u"&&(e[t]=null)},_eqNull:function(e){return typeof e>"u"||e===null},_adjustSettings:function(e,i,t){for(var s=null,r=0;r<this._serverSyncs.length;r++)if(this._serverSyncs[r][0]===i.options.serverSync){s=this._serverSyncs[r][1];break}var n=null,o=null;if(this._eqNull(s)){var _=m.isFunction(i.options.serverSync)?i.options.serverSync.apply(e[0],[]):null;n=new Date,o=_?n.getTime()-_.getTime():0,this._serverSyncs.push([i.options.serverSync,o])}else n=new Date,o=i.options.serverSync?s:0;var a=i.options.timezone;a=this._eqNull(a)?-n.getTimezoneOffset():a,(t||!t&&this._eqNull(i._until)&&this._eqNull(i._since))&&(i._since=i.options.since,this._eqNull(i._since)||(i._since=this.UTCDate(a,this._determineTime(i._since,null)),i._since&&o&&i._since.setMilliseconds(i._since.getMilliseconds()+o)),i._until=this.UTCDate(a,this._determineTime(i.options.until,n)),o&&i._until.setMilliseconds(i._until.getMilliseconds()+o)),i._show=this._determineShow(i)},_preDestroy:function(e,i){this._removeElem(e[0]),e.empty()},pause:function(e){this._hold(e,"pause")},lap:function(e){this._hold(e,"lap")},resume:function(e){this._hold(e,null)},toggle:function(e){var i=m.data(e,this.name)||{};this[i._hold?"resume":"pause"](e)},toggleLap:function(e){var i=m.data(e,this.name)||{};this[i._hold?"resume":"lap"](e)},_hold:function(e,i){var t=m.data(e,this.name);if(t){if(t._hold==="pause"&&!i){t._periods=t._savePeriods;var s=t._since?"-":"+";t[t._since?"_since":"_until"]=this._determineTime(s+t._periods[0]+"y"+s+t._periods[1]+"o"+s+t._periods[2]+"w"+s+t._periods[3]+"d"+s+t._periods[4]+"h"+s+t._periods[5]+"m"+s+t._periods[6]+"s"),this._addElem(e)}t._hold=i,t._savePeriods=i==="pause"?t._periods:null,m.data(e,this.name,t),this._updateCountdown(e,t)}},getTimes:function(e){var i=m.data(e,this.name);return i?i._hold==="pause"?i._savePeriods:i._hold?this._calculatePeriods(i,i._show,i.options.significant,new Date):i._periods:null},_determineTime:function(e,i){var t=this,s=function(o){var _=new Date;return _.setTime(_.getTime()+1e3*o),_},r=function(o){o=o.toLowerCase();for(var _=new Date,a=_.getFullYear(),l=_.getMonth(),w=_.getDate(),M=_.getHours(),c=_.getMinutes(),p=_.getSeconds(),u=/([+-]?[0-9]+)\s*(s|m|h|d|w|o|y)?/g,h=u.exec(o);h;){switch(h[2]||"s"){case"s":p+=parseInt(h[1],10);break;case"m":c+=parseInt(h[1],10);break;case"h":M+=parseInt(h[1],10);break;case"d":w+=parseInt(h[1],10);break;case"w":w+=7*parseInt(h[1],10);break;case"o":l+=parseInt(h[1],10),w=Math.min(w,t._getDaysInMonth(a,l));break;case"y":a+=parseInt(h[1],10),w=Math.min(w,t._getDaysInMonth(a,l))}h=u.exec(o)}return new Date(a,l,w,M,c,p,0)},n=this._eqNull(e)?i:typeof e=="string"?r(e):typeof e=="number"?s(e):e;return n&&n.setMilliseconds(0),n},_getDaysInMonth:function(e,i){return 32-new Date(e,i,32).getDate()},_normalLabels:function(e){return e},_generateHTML:function(e){var i=this;e._periods=e._hold?e._periods:this._calculatePeriods(e,e._show,e.options.significant,new Date);var t=!1,s=0,r=e.options.significant,n=m.extend({},e._show),o=null;for(o=d;o<=g;o++)t=t||e._show[o]==="?"&&e._periods[o]>0,n[o]=e._show[o]!=="?"||t?e._show[o]:null,s+=n[o]?1:0,r-=e._periods[o]>0?1:0;var _=[!1,!1,!1,!1,!1,!1,!1];for(o=g;o>=d;o--)e._show[o]&&(e._periods[o]?_[o]=!0:(_[o]=r>0,r--));var a=e.options.compact?e.options.compactLabels:e.options.labels,l=e.options.whichLabels||this._normalLabels,w=function(p){var u=e.options["compactLabels"+l(e._periods[p])];return n[p]?i._translateDigits(e,e._periods[p])+(u?u[p]:a[p])+" ":""},M=e.options.padZeroes?2:1,c=function(p){var u=e.options["labels"+l(e._periods[p])];return!e.options.significant&&n[p]||e.options.significant&&_[p]?'<span class="'+i._sectionClass+'"><span class="'+i._amountClass+'">'+i._minDigits(e,e._periods[p],M)+'</span><span class="'+i._periodClass+'">'+(u?u[p]:a[p])+"</span></span>":""};return e.options.layout?this._buildLayout(e,n,e.options.layout,e.options.compact,e.options.significant,_):(e.options.compact?'<span class="'+this._rowClass+" "+this._amountClass+(e._hold?" "+this._holdingClass:"")+'">'+w(d)+w(f)+w(D)+w(T)+(n[y]?this._minDigits(e,e._periods[y],2):"")+(n[v]?(n[y]?e.options.timeSeparator:"")+this._minDigits(e,e._periods[v],2):"")+(n[g]?(n[y]||n[v]?e.options.timeSeparator:"")+this._minDigits(e,e._periods[g],2):""):'<span class="'+this._rowClass+" "+this._showClass+(e.options.significant||s)+(e._hold?" "+this._holdingClass:"")+'">'+c(d)+c(f)+c(D)+c(T)+c(y)+c(v)+c(g))+"</span>"+(e.options.description?'<span class="'+this._rowClass+" "+this._descrClass+'">'+e.options.description+"</span>":"")},_buildLayout:function(e,i,t,s,r,n){for(var o=e.options[s?"compactLabels":"labels"],_=e.options.whichLabels||this._normalLabels,a=function(h){return(e.options[(s?"compactLabels":"labels")+_(e._periods[h])]||o)[h]},l=function(h,E){return e.options.digits[Math.floor(h/E)%10]},w={desc:e.options.description,sep:e.options.timeSeparator,yl:a(d),yn:this._minDigits(e,e._periods[d],1),ynn:this._minDigits(e,e._periods[d],2),ynnn:this._minDigits(e,e._periods[d],3),y1:l(e._periods[d],1),y10:l(e._periods[d],10),y100:l(e._periods[d],100),y1000:l(e._periods[d],1e3),ol:a(f),on:this._minDigits(e,e._periods[f],1),onn:this._minDigits(e,e._periods[f],2),onnn:this._minDigits(e,e._periods[f],3),o1:l(e._periods[f],1),o10:l(e._periods[f],10),o100:l(e._periods[f],100),o1000:l(e._periods[f],1e3),wl:a(D),wn:this._minDigits(e,e._periods[D],1),wnn:this._minDigits(e,e._periods[D],2),wnnn:this._minDigits(e,e._periods[D],3),w1:l(e._periods[D],1),w10:l(e._periods[D],10),w100:l(e._periods[D],100),w1000:l(e._periods[D],1e3),dl:a(T),dn:this._minDigits(e,e._periods[T],1),dnn:this._minDigits(e,e._periods[T],2),dnnn:this._minDigits(e,e._periods[T],3),d1:l(e._periods[T],1),d10:l(e._periods[T],10),d100:l(e._periods[T],100),d1000:l(e._periods[T],1e3),hl:a(y),hn:this._minDigits(e,e._periods[y],1),hnn:this._minDigits(e,e._periods[y],2),hnnn:this._minDigits(e,e._periods[y],3),h1:l(e._periods[y],1),h10:l(e._periods[y],10),h100:l(e._periods[y],100),h1000:l(e._periods[y],1e3),ml:a(v),mn:this._minDigits(e,e._periods[v],1),mnn:this._minDigits(e,e._periods[v],2),mnnn:this._minDigits(e,e._periods[v],3),m1:l(e._periods[v],1),m10:l(e._periods[v],10),m100:l(e._periods[v],100),m1000:l(e._periods[v],1e3),sl:a(g),sn:this._minDigits(e,e._periods[g],1),snn:this._minDigits(e,e._periods[g],2),snnn:this._minDigits(e,e._periods[g],3),s1:l(e._periods[g],1),s10:l(e._periods[g],10),s100:l(e._periods[g],100),s1000:l(e._periods[g],1e3)},M=t,c=d;c<=g;c++){var p="yowdhms".charAt(c),u=new RegExp("\\{"+p+"<\\}([\\s\\S]*)\\{"+p+">\\}","g");M=M.replace(u,!r&&i[c]||r&&n[c]?"$1":"")}return m.each(w,function(h,E){var x=new RegExp("\\{"+h+"\\}","g");M=M.replace(x,E)}),M},_minDigits:function(e,i,t){return i=""+i,i.length>=t?this._translateDigits(e,i):(i="0000000000"+i,this._translateDigits(e,i.substr(i.length-t)))},_translateDigits:function(e,i){return(""+i).replace(/[0-9]/g,function(t){return e.options.digits[t]})},_determineShow:function(e){var i=e.options.format,t=[];return t[d]=i.match("y")?"?":i.match("Y")?"!":null,t[f]=i.match("o")?"?":i.match("O")?"!":null,t[D]=i.match("w")?"?":i.match("W")?"!":null,t[T]=i.match("d")?"?":i.match("D")?"!":null,t[y]=i.match("h")?"?":i.match("H")?"!":null,t[v]=i.match("m")?"?":i.match("M")?"!":null,t[g]=i.match("s")?"?":i.match("S")?"!":null,t},_calculatePeriods:function(e,i,t,s){e._now=s,e._now.setMilliseconds(0);var r=new Date(e._now.getTime());e._since?s.getTime()<e._since.getTime()?e._now=s=r:s=e._since:(r.setTime(e._until.getTime()),s.getTime()>e._until.getTime()&&(e._now=s=r));var n=[0,0,0,0,0,0,0];if(i[d]||i[f]){var o=this._getDaysInMonth(s.getFullYear(),s.getMonth()),_=this._getDaysInMonth(r.getFullYear(),r.getMonth()),a=r.getDate()===s.getDate()||r.getDate()>=Math.min(o,_)&&s.getDate()>=Math.min(o,_),l=function(C){return 60*(60*C.getHours()+C.getMinutes())+C.getSeconds()},w=Math.max(0,12*(r.getFullYear()-s.getFullYear())+r.getMonth()-s.getMonth()+(r.getDate()<s.getDate()&&!a||a&&l(r)<l(s)?-1:0));n[d]=i[d]?Math.floor(w/12):0,n[f]=i[f]?w-12*n[d]:0,s=new Date(s.getTime());var M=s.getDate()===o,c=this._getDaysInMonth(s.getFullYear()+n[d],s.getMonth()+n[f]);s.getDate()>c&&s.setDate(c),s.setFullYear(s.getFullYear()+n[d]),s.setMonth(s.getMonth()+n[f]),M&&s.setDate(c)}var p=Math.floor((r.getTime()-s.getTime())/1e3),u=null,h=function(C,F){n[C]=i[C]?Math.floor(p/F):0,p-=n[C]*F};if(h(D,604800),h(T,86400),h(y,3600),h(v,60),h(g,1),p>0&&!e._since){var E=[1,12,4.3482,7,24,60,60],x=g,L=1;for(u=g;u>=d;u--)i[u]&&(n[x]>=L&&(n[x]=0,p=1),p>0&&(n[u]++,p=0,x=u,L=1)),L*=E[u]}if(t)for(u=d;u<=g;u++)t&&n[u]?t--:t||(n[u]=0);return n}})})(jQuery);
