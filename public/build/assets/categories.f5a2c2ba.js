import{aw as V,ax as he,ay as d,az as k,a0 as X,p as E,s as ke,aA as be,h as g,aB as b,aC as Te,aD as ee,aE as we,aF as $e,aG as Fe,aH as Pe,aI as _,aJ as Y,aK as Ae,aL as Be,aM as Me,V as z,aN as Ne,aO as Le,u as G,Z as Oe,aP as Re,q as B,aa as Se,aQ as $}from"./app-setting.176c951c.js";import{c as Ie,B as De,M as h,o as Ee,i as je}from"./Modal.333891ea.js";function He(e,a,l){V(he(e,d({},a)),l)}const Ve=()=>{const e=k(!1);return X(()=>{e.value=!0}),e},ze=Ve,qe={type:{type:String},actionFn:Function,close:Function,autofocus:Boolean,prefixCls:String,buttonProps:Te(),emitEvent:Boolean,quitOnNullishReturnValue:Boolean};function J(e){return!!(e&&e.then)}const Z=E({compatConfig:{MODE:3},name:"ActionButton",props:qe,setup(e,a){let{slots:l}=a;const r=k(!1),y=k(),o=k(!1);let f;const m=ze();ke(()=>{e.autofocus&&(f=setTimeout(()=>{var t,c;return(c=(t=be(y.value))===null||t===void 0?void 0:t.focus)===null||c===void 0?void 0:c.call(t)}))}),X(()=>{clearTimeout(f)});const x=function(){for(var t,c=arguments.length,n=new Array(c),v=0;v<c;v++)n[v]=arguments[v];(t=e.close)===null||t===void 0||t.call(e,...n)},u=t=>{!J(t)||(o.value=!0,t.then(function(){m.value||(o.value=!1),x(...arguments),r.value=!1},c=>(m.value||(o.value=!1),r.value=!1,Promise.reject(c))))},i=t=>{const{actionFn:c}=e;if(r.value)return;if(r.value=!0,!c){x();return}let n;if(e.emitEvent){if(n=c(t),e.quitOnNullishReturnValue&&!J(n)){r.value=!1,x(t);return}}else if(c.length)n=c(e.close),r.value=!1;else if(n=c(),!n){x();return}u(n)};return()=>{const{type:t,prefixCls:c,buttonProps:n}=e;return g(De,b(b(b({},Ie(t)),{},{onClick:i,loading:o.value,prefixCls:c},n),{},{ref:y}),l)}}});function M(e){return typeof e=="function"?e():e}const te=E({name:"ConfirmDialog",inheritAttrs:!1,props:["icon","onCancel","onOk","close","closable","zIndex","afterClose","visible","open","keyboard","centered","getContainer","maskStyle","okButtonProps","cancelButtonProps","okType","prefixCls","okCancel","width","mask","maskClosable","okText","cancelText","autoFocusButton","transitionName","maskTransitionName","type","title","content","direction","rootPrefixCls","bodyStyle","closeIcon","modalRender","focusTriggerAfterClose","wrapClassName","confirmPrefixCls","footer"],setup(e,a){let{attrs:l}=a;const[r]=ee("Modal");return()=>{const{icon:y,onCancel:o,onOk:f,close:m,okText:x,closable:u=!1,zIndex:i,afterClose:t,keyboard:c,centered:n,getContainer:v,maskStyle:s,okButtonProps:C,cancelButtonProps:R,okCancel:A,width:p=416,mask:F=!0,maskClosable:T=!1,type:w,open:S,title:q,content:ce,direction:ie,closeIcon:ue,modalRender:fe,focusTriggerAfterClose:de,rootPrefixCls:I,bodyStyle:ve,wrapClassName:Ce,footer:Q}=e;let N=y;if(!y&&y!==null)switch(w){case"info":N=g(Pe,null,null);break;case"success":N=g(Fe,null,null);break;case"error":N=g($e,null,null);break;default:N=g(we,null,null)}const me=e.okType||"primary",j=e.prefixCls||"ant-modal",L=`${j}-confirm`,ge=l.style||{},K=A!=null?A:w==="confirm",W=e.autoFocusButton===null?!1:e.autoFocusButton||"ok",D=`${j}-confirm`,ye=_(D,`${D}-${e.type}`,{[`${D}-rtl`]:ie==="rtl"},l.class),H=r.value,pe=K&&g(Z,{actionFn:o,close:m,autofocus:W==="cancel",buttonProps:R,prefixCls:`${I}-btn`},{default:()=>[M(e.cancelText)||H.cancelText]});return g(h,{prefixCls:j,class:ye,wrapClassName:_({[`${D}-centered`]:!!n},Ce),onCancel:xe=>m==null?void 0:m({triggerCancel:!0},xe),open:S,title:"",footer:"",transitionName:Y(I,"zoom",e.transitionName),maskTransitionName:Y(I,"fade",e.maskTransitionName),mask:F,maskClosable:T,maskStyle:s,style:ge,bodyStyle:ve,width:p,zIndex:i,afterClose:t,keyboard:c,centered:n,getContainer:v,closable:u,closeIcon:ue,modalRender:fe,focusTriggerAfterClose:de},{default:()=>[g("div",{class:`${L}-body-wrapper`},[g("div",{class:`${L}-body`},[M(N),q===void 0?null:g("span",{class:`${L}-title`},[M(q)]),g("div",{class:`${L}-content`},[M(ce)])]),Q!==void 0?M(Q):g("div",{class:`${L}-btns`},[pe,g(Z,{type:me,actionFn:f,close:m,autofocus:W==="ok",buttonProps:C,prefixCls:`${I}-btn`},{default:()=>[M(x)||(K?H.okText:H.justOkText)]})])])]})}}}),Qe=[],P=Qe,Ke=e=>{const a=document.createDocumentFragment();let l=d(d({},Ee(e,["parentContext","appContext"])),{close:o,open:!0}),r=null;function y(){r&&(V(null,a),r=null);for(var u=arguments.length,i=new Array(u),t=0;t<u;t++)i[t]=arguments[t];const c=i.some(n=>n&&n.triggerCancel);e.onCancel&&c&&e.onCancel(()=>{},...i.slice(1));for(let n=0;n<P.length;n++)if(P[n]===o){P.splice(n,1);break}}function o(){for(var u=arguments.length,i=new Array(u),t=0;t<u;t++)i[t]=arguments[t];l=d(d({},l),{open:!1,afterClose:()=>{typeof e.afterClose=="function"&&e.afterClose(),y.apply(this,i)}}),l.visible&&delete l.visible,f(l)}function f(u){typeof u=="function"?l=u(l):l=d(d({},l),u),r&&He(r,l,a)}const m=u=>{const i=Me,t=i.prefixCls,c=u.prefixCls||`${t}-modal`,n=i.iconPrefixCls,v=Ae();return g(Be,b(b({},i),{},{prefixCls:t}),{default:()=>[g(te,b(b({},u),{},{rootPrefixCls:t,prefixCls:c,iconPrefixCls:n,locale:v,cancelText:u.cancelText||v.cancelText}),null)]})};function x(u){const i=g(m,d({},u));return i.appContext=e.parentContext||e.appContext||i.appContext,V(i,a),i}return r=x(l),P.push(o),{destroy:o,update:f}},O=Ke;function oe(e){return d(d({},e),{type:"warning"})}function ne(e){return d(d({},e),{type:"info"})}function ae(e){return d(d({},e),{type:"success"})}function le(e){return d(d({},e),{type:"error"})}function se(e){return d(d({},e),{type:"confirm"})}const We=()=>({config:Object,afterClose:Function,destroyAction:Function,open:Boolean}),_e=E({name:"HookModal",inheritAttrs:!1,props:je(We(),{config:{width:520,okType:"primary"}}),setup(e,a){let{expose:l}=a;var r;const y=z(()=>e.open),o=z(()=>e.config),{direction:f,getPrefixCls:m}=Ne(),x=m("modal"),u=m(),i=()=>{var v,s;e==null||e.afterClose(),(s=(v=o.value).afterClose)===null||s===void 0||s.call(v)},t=function(){e.destroyAction(...arguments)};l({destroy:t});const c=(r=o.value.okCancel)!==null&&r!==void 0?r:o.value.type==="confirm",[n]=ee("Modal",Le.Modal);return()=>g(te,b(b({prefixCls:x,rootPrefixCls:u},o.value),{},{close:t,open:y.value,afterClose:i,okText:o.value.okText||(c?n==null?void 0:n.value.okText:n==null?void 0:n.value.justOkText),direction:o.value.direction||f.value,cancelText:o.value.cancelText||(n==null?void 0:n.value.cancelText)}),null)}});let U=0;const Ye=E({name:"ElementsHolder",inheritAttrs:!1,setup(e,a){let{expose:l}=a;const r=k([]);return l({addModal:o=>(r.value.push(o),r.value=r.value.slice(),()=>{r.value=r.value.filter(f=>f!==o)})}),()=>r.value.map(o=>o())}});function Ge(){const e=k(null),a=k([]);G(a,()=>{a.value.length&&([...a.value].forEach(f=>{f()}),a.value=[])},{immediate:!0});const l=o=>function(m){var x;U+=1;const u=k(!0),i=k(null),t=k(Oe(m)),c=k({});G(()=>m,p=>{C(d(d({},Re(p)?p.value:p),c.value))});const n=function(){u.value=!1;for(var p=arguments.length,F=new Array(p),T=0;T<p;T++)F[T]=arguments[T];const w=F.some(S=>S&&S.triggerCancel);t.value.onCancel&&w&&t.value.onCancel(()=>{},...F.slice(1))};let v;const s=()=>g(_e,{key:`modal-${U}`,config:o(t.value),ref:i,open:u.value,destroyAction:n,afterClose:()=>{v==null||v()}},null);v=(x=e.value)===null||x===void 0?void 0:x.addModal(s),v&&P.push(v);const C=p=>{t.value=d(d({},t.value),p)};return{destroy:()=>{i.value?n():a.value=[...a.value,n]},update:p=>{c.value=p,i.value?C(p):a.value=[...a.value,()=>C(p)]}}},r=z(()=>({info:l(ne),success:l(ae),error:l(le),warning:l(oe),confirm:l(se)})),y=Symbol("modalHolderKey");return[r.value,()=>g(Ye,{key:y,ref:e},null)]}function re(e){return O(oe(e))}h.useModal=Ge;h.info=function(a){return O(ne(a))};h.success=function(a){return O(ae(a))};h.error=function(a){return O(le(a))};h.warning=re;h.warn=re;h.confirm=function(a){return O(se(a))};h.destroyAll=function(){for(;P.length;){const a=P.pop();a&&a()}};h.install=function(e){return e.component(h.name,h),e};function Ue(){const e=B([]),a=B([]),l=B([]),r=B({name:"",description:""}),y=Se(),o=B({}),f=B(!1),m=async(s=1,C="",R="",A="",p="",F="created_at",T="desc")=>{try{const w=await $("get",`/api/categories?page=${s}&search_id=${C}&search_title=${R}&search_parent_id=${A}&search_global=${p}&order_column=${F}&order_direction=${T}`);e.value=w}catch(w){o.value=w}};return{categoryList:a,categoryMainList:l,categories:e,category:r,getCategories:m,getMainCategoryList:async()=>{try{const s=await $("get","/api/category-main");l.value=s}catch(s){o.value=s}},getSelectedCategoryList:async s=>{try{const C=await $("get",`/api/category-list/${s}`);a.value=C.data}catch(C){o.value=C}},getCategoryList:async()=>{try{const s=await $("get","/api/category-list");a.value=s.data}catch(s){o.value=s}},getCategory:async s=>{try{const C=await $("get",`/api/categories/${s}`);r.value=C.data}catch(C){o.value=C}},storeCategory:async s=>{if(!f.value){f.value=!0,o.value={};try{await $("post","/api/categories",s),y.push({name:"categories.create"}),s.name=null,s.description=null,s.is_published=null,showToast("Category saved successfully","success")}catch(C){o.value=C}finally{f.value=!1}}},updateCategory:async s=>{if(!f.value){f.value=!0,o.value={};try{await $("put",`/api/categories/${s.id}`,s),y.push({name:"categories.index"}),showToast("Category updated successfully","success")}catch(C){o.value=C}finally{f.value=!1}}},deleteCategory:async s=>{h.confirm({title:"Are you sure?",content:"You won't be able to revert this action!",okText:"Yes, delete it!",okType:"danger",cancelText:"No, cancel",onOk(){$("delete",`/api/categories/${s}`).then(()=>{m(),y.push({name:"categories.index"}),showToast("Category deleted successfully","success")}).catch(C=>{o.value=C})},onCancel(){console.log("Cancel")}})},validationErrors:o,isLoading:f}}export{Ue as u};
