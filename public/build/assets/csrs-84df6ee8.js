import{v as c,b as v,d as i}from"./index-18a95f05.js";function P(){const h=c.ref([]),g=c.ref([]),m=c.ref({name:"",description:"",is_published:""}),p=v(),u=c.ref({}),l=c.ref(!1),o=c.inject("$swal"),f=async(t=1,r="",s="",n="",d="created_at",e="desc")=>{i.get("/api/csrs?page="+t+"&search_id="+r+"&search_title="+s+"&search_global="+n+"&order_column="+d+"&order_direction="+e).then(a=>{h.value=a.data})};return{csrList:g,csrs:h,csr:m,getCsrs:f,getCsrList:async()=>{i.get("/api/csr-list").then(t=>{g.value=t.data.data})},getCsr:async t=>{i.get("/api/csrs/"+t).then(r=>{m.value=r.data.data})},storeCsr:async(t,r)=>{if(l.value)return;console.log(t),l.value=!0,u.value={};let s=new FormData;for(var n=0;n<r.length;n++){let e=r[n];s.append("csr_gallery["+n+"]",e)}for(let e in t)t.hasOwnProperty(e)&&s.append(e,t[e]);const d={headers:{"content-type":"multipart/form-data"}};i.post("/api/csrs",s,d).then(e=>{p.push({name:"csrs.create"}),t.name=null,t.csr_introduction=null,t.company_involvement=null,t.collaborations_and_partnership=null,t.main_image=null,t.csr_gallery=null,o({icon:"success",title:"CSR saved successfully"})}).catch(e=>{var a;(a=e.response)!=null&&a.data&&(u.value=e.response.data.errors)}).finally(()=>l.value=!1)},updateCsr:async(t,r)=>{if(l.value)return;l.value=!0,u.value={};let s=new FormData;if(r.length>0)for(var n=0;n<r.length;n++){let e=r[n];s.append("csr_gallery["+n+"]",e)}for(let e in t)if(t.hasOwnProperty(e)&&e!=="categories"){let a=t[e];a===null&&(e==="weight"||e==="length"||e==="height"||e==="width"||e==="quantity"||e==="cost_price"||e==="retail_price")&&(a=0),s.append(e,a)}const d={headers:{"Content-Type":"multipart/form-data"}};s.append("_method","put"),console.log(s),await i.post("/api/csrs/"+t.id,s,d).then(e=>{p.push({name:"csrs.index"}),o({icon:"success",title:"CSR updated successfully"})}).catch(e=>{var a;(a=e.response)!=null&&a.data&&(u.value=e.response.data.errors)}).finally(()=>l.value=!1)},deleteCsr:async t=>{o({title:"Are you sure?",text:"You won't be able to revert this action!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",confirmButtonColor:"#ef4444",timer:2e4,timerProgressBar:!0,reverseButtons:!0}).then(r=>{r.isConfirmed&&i.delete("/api/csrs/"+t).then(s=>{f(),p.push({name:"csrs.index"}),o({icon:"success",title:"CSR deleted successfully"})}).catch(s=>{o({icon:"error",title:"Something went wrong"})})})},deleteCsrImage:async t=>{o({title:"Are you sure?",text:"You won't be able to revert this action!",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete it!",confirmButtonColor:"#ef4444",timer:2e4,timerProgressBar:!0,reverseButtons:!0}).then(r=>{r.isConfirmed&&i.delete("/api/csr-images/"+t).then(s=>{f(),p.go(0),o({icon:"success",title:"Image deleted successfully"})}).catch(s=>{o({icon:"error",title:"Something went wrong"})})})},validationErrors:u,isLoading:l}}export{P as u};
